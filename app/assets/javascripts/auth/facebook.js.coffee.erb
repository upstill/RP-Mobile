jQuery ->
	$('body').prepend('<div id="fb-root"></div>')

	$.ajax
		url: "#{window.location.protocol}//connect.facebook.net/en_US/all.js"
		dataType: 'script'
		cache: true

RP.facebook ||= {}

RP.facebook.connect = ->
	RP.modal_notify "Hang on while we check with Facebook..."
	FB.login (response) ->
		window.location = '/auth/facebook/callback' if response.authResponse

window.fbAsyncInit = ->
	FB.init(appId: '<%= ENV["FACEBOOK_APP_ID"] %>', cookie: true)
